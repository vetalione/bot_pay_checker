# üîî –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –¥–ª—è video1

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Å—Ç—Ä—è–ª–∏ –Ω–∞ –ø–µ—Ä–≤–æ–º –≤–∏–¥–µ–æ (`video1`) –∏ –Ω–µ –ø—Ä–æ–¥–æ–ª–∂–∏–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –≤ —Ç–µ—á–µ–Ω–∏–µ **10 –º–∏–Ω—É—Ç**.

## üìä –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –¢—Ä–∏–≥–≥–µ—Ä

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
- ‚úÖ –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É **"–•–æ—á—É —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ"**
- ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ
- ‚ùå **–ù–ï –Ω–∞–∂–∏–º–∞–µ—Ç** –∫–Ω–æ–ø–∫—É "–°–º–æ—Ç—Ä–µ—Ç—å –¥–∞–ª—å—à–µ" –≤ —Ç–µ—á–µ–Ω–∏–µ 10 –º–∏–Ω—É—Ç

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ

**–ß–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
–ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ? –ü–æ–Ω–∏–º–∞—é, —è —Ç–æ–∂–µ –≤—Å–µ –≤—Ä–µ–º—è –Ω–∞ –±–µ–≥—É. 
–•–æ—á–µ—à—å —è –ø—Ä–æ—Å—Ç–æ —Å—Ä–∞–∑—É –¥–∞–º —Ç–µ–±–µ —Å—Å—ã–ª–∫—É –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π –∫–∞–Ω–∞–ª 
—Å–æ –≤—Å–µ–º–∏ –º–æ–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è?

[‚ú® –•–æ—á—É!]
```

### 3. –î–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫—É **"–•–æ—á—É!"**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ø–∞–¥–∞–µ—Ç –Ω–∞ —ç–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ –æ–ø–ª–∞—Ç—ã
- –í–∏–¥–∏—Ç –∫–Ω–æ–ø–∫–∏: **üíµ –†—É–±–ª–∏ (RUB)** –∏ **üí¥ –ì—Ä–∏–≤–Ω—ã (UAH)**
- –î–∞–ª–µ–µ –∏–¥–µ—Ç –æ–±—ã—á–Ω—ã–π —Ñ–ª–æ—É –æ–ø–ª–∞—Ç—ã

### 4. –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **–û–î–ò–ù –†–ê–ó**
- ‚úÖ –¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å `currentStep = 'video1'`
- ‚úÖ –¢–æ–ª—å–∫–æ –¥–ª—è `hasPaid = false`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –ø—Ä–æ–≤–µ—Ä–∫–∞)

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ù–æ–≤—ã–µ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `users`

```typescript
video1ShownAt?: Date;        // –í—Ä–µ–º—è –ø–æ–∫–∞–∑–∞ –ø–µ—Ä–≤–æ–≥–æ –≤–∏–¥–µ–æ
video1ReminderSent: boolean; // –§–ª–∞–≥ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
```

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

```typescript
VIDEO1_REMINDER_DELAY_MS = 10 * 60 * 1000; // 10 –º–∏–Ω—É—Ç
```

### –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –≤ `ReminderService`:

```typescript
checkVideo1Reminders()
```

**–£—Å–ª–æ–≤–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏:**
1. `currentStep = 'video1'`
2. `hasPaid = false`
3. `video1ReminderSent = false`
4. `video1ShownAt <= NOW() - 10 –º–∏–Ω—É—Ç`

## üìà –í–æ—Ä–∫—Ñ–ª–æ—É

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–•–æ—á—É —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ"
    ‚Üì
–ü–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ
    ‚Üì
video1ShownAt = NOW() ‚Üê –§–ò–ö–°–ò–†–£–ï–ú –í–†–ï–ú–Ø
    ‚Üì
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "–°–º–æ—Ç—Ä–µ—Ç—å –¥–∞–ª—å—à–µ"
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ñ–î–ï–ú 10 –ú–ò–ù–£–¢                           ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ –í–∞—Ä–∏–∞–Ω—Ç –ê: –ù–∞–∂–∞–ª "–°–º–æ—Ç—Ä–µ—Ç—å –¥–∞–ª—å—à–µ"     ‚îÇ
‚îÇ ‚Üí –ò–¥–µ—Ç –Ω–∞ video2, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ù–ï —à–ª–µ—Ç—Å—è‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ –í–∞—Ä–∏–∞–Ω—Ç –ë: –ù–µ –Ω–∞–∂–∞–ª –Ω–∏—á–µ–≥–æ             ‚îÇ
‚îÇ ‚Üí –ß–µ—Ä–µ–∑ 10 –º–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚Üì
–ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï:
"–ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ?..."
[‚ú® –•–æ—á—É!]
    ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç "–•–æ—á—É!"
    ‚Üì
–ü–æ–ø–∞–¥–∞–µ—Ç –Ω–∞ –≤—ã–±–æ—Ä –æ–ø–ª–∞—Ç—ã:
[üíµ –†—É–±–ª–∏] [üí¥ –ì—Ä–∏–≤–Ω—ã]
    ‚Üì
–í—ã–±–∏—Ä–∞–µ—Ç –≤–∞–ª—é—Ç—É
    ‚Üì
–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ–ø–ª–∞—Ç–µ
    ‚Üì
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–≤–∏—Ç–∞–Ω—Ü–∏—é
    ‚Üì
‚úÖ –î–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª—É
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
- –†–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ—Ç–µ—Ä—è–≤—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å –∫ –≤–∏–¥–µ–æ
- –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å –∫ –ø–æ–∫—É–ø–∫–µ

### 2. –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ: "—è —Ç–æ–∂–µ –≤—Å–µ –≤—Ä–µ–º—è –Ω–∞ –±–µ–≥—É"
- –≠–º–ø–∞—Ç–∏—è –∫ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- –†–∞–±–æ—Ç–∞–µ—Ç 24/7 –±–µ–∑ —É—á–∞—Å—Ç–∏—è —á–µ–ª–æ–≤–µ–∫–∞
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### 4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–æ—Ä–æ–Ω–∫–∏
- –°–æ–∫—Ä–∞—â–∞–µ—Ç –ø—É—Ç—å –æ—Ç –≤–∏–¥–µ–æ1 –¥–æ –æ–ø–ª–∞—Ç—ã
- –£–±–∏—Ä–∞–µ—Ç –±–∞—Ä—å–µ—Ä "–Ω—É–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –≤–∏–¥–µ–æ"

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

### –í –ª–æ–≥–∞—Ö Railway:

```
üìä –ù–∞–π–¥–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (video1): X
üîî –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è video1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é 123456789
‚úÖ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ video1 –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é 123456789
```

### –í –∫–æ–º–∞–Ω–¥–µ `/stats`:

–î–æ –∏ –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å—Ä–∞–≤–Ω–∏—Ç–µ:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Å—Ç—Ä—è–≤—à–∏—Ö –Ω–∞ video1
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ payment_choice
- –û–±—â—É—é –∫–æ–Ω–≤–µ—Ä—Å–∏—é

### SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:

```sql
-- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π video1
SELECT 
  COUNT(*) as total_reminders_sent,
  COUNT(CASE WHEN "currentStep" != 'video1' THEN 1 END) as moved_forward,
  COUNT(CASE WHEN "hasPaid" = true THEN 1 END) as converted_to_paid
FROM users 
WHERE "video1ReminderSent" = true;
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π:

```sql
-- –ö–æ–º—É –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ –±–ª–∏–∂–∞–π—à—É—é –º–∏–Ω—É—Ç—É?
SELECT 
  "userId",
  username,
  "video1ShownAt",
  EXTRACT(EPOCH FROM (NOW() - "video1ShownAt"))/60 as minutes_ago,
  "video1ReminderSent"
FROM users 
WHERE "currentStep" = 'video1' 
  AND "hasPaid" = false
  AND "video1ReminderSent" = false
  AND "video1ShownAt" <= NOW() - INTERVAL '10 minutes'
ORDER BY "video1ShownAt" DESC
LIMIT 20;
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –µ—Å–ª–∏:

- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –Ω–∞–∂–∞–ª "–°–º–æ—Ç—Ä–µ—Ç—å –¥–∞–ª—å—à–µ" (–ø–µ—Ä–µ—à–µ–ª –Ω–∞ video2)
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –æ–ø–ª–∞—Ç–∏–ª (`hasPaid = true`)
- ‚ùå –ü—Ä–æ—à–ª–æ –º–µ–Ω—å—à–µ 10 –º–∏–Ω—É—Ç —Å –ø–æ–∫–∞–∑–∞ video1
- ‚ùå –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å (`video1ReminderSent = true`)

### –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞

–§–ª–∞–≥ `video1ReminderSent` **–ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è**. –≠—Ç–æ —Ä–∞–∑–æ–≤–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

```sql
UPDATE users 
SET "video1ReminderSent" = false 
WHERE "userId" = 123456789;
```

## üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏

| –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ | –ó–∞–¥–µ—Ä–∂–∫–∞ | –£—Å–ª–æ–≤–∏–µ | –°–æ–æ–±—â–µ–Ω–∏–µ |
|-------------|----------|---------|-----------|
| **Payment Choice** | 5 –º–∏–Ω—É—Ç | `payment_choice` | "–•–æ—á–µ—à—å –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–±?" |
| **Receipt (RUB)** | 5 –º–∏–Ω—É—Ç | `waiting_receipt` + RUB | "–ß—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ–ø–ª–∞—Ç–æ–π?" |
| **Video1** | 10 –º–∏–Ω—É—Ç | `video1` | "–ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ?" |

## üöÄ –î–µ–ø–ª–æ–π

–ü–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ GitHub:
1. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç
2. TypeORM —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–µ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
3. ReminderService –Ω–∞—á–Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å video1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. –ß–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç –ø–µ—Ä–≤—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –Ω–∞—á–Ω—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `src/entities/User.ts` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `video1ShownAt`, `video1ReminderSent`
- `src/userService.ts` - –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `markVideo1Shown()`
- `src/reminderService.ts` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã `checkVideo1Reminders()`, `sendVideo1Reminder()`
- `src/index.ts` - –¥–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `markVideo1Shown()` –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `video1_skip_to_payment`

---

**–°–æ–∑–¥–∞–Ω–æ:** 2 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–¶–µ–ª—å:** –†–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞—Å—Ç—Ä—è–≤—à–∏—Ö –Ω–∞ video1
