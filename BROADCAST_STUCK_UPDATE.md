# üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ broadcast-stuck

## –î–∞—Ç–∞: 5 –Ω–æ—è–±—Ä—è 2025

### ‚úÖ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

–°–∫—Ä–∏–ø—Ç `scripts/send_stuck_users_message.ts` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫ –æ–ø–ª–∞—Ç—ã —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –∫–ª–∏–∫–æ–≤.

---

## üìã –ë—ã–ª–æ (—Å—Ç–∞—Ä—ã–µ –∫–Ω–æ–ø–∫–∏):

```typescript
Markup.inlineKeyboard([
  [
    Markup.button.callback('üíµ –†—É–±–ª–∏ (RUB)', 'pay_rub'),      // ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!
    Markup.button.callback('üí¥ –ì—Ä–∏–≤–Ω—ã (UAH)', 'pay_uah')
  ]
])
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –ö–Ω–æ–ø–∫–∞ `pay_rub` –≤–µ–¥–µ—Ç –Ω–∞ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
- ‚ùå –ù–µ—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è EUR (–∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç)
- ‚ùå –¢–æ–ª—å–∫–æ 2 —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã –≤–º–µ—Å—Ç–æ 3

---

## üìã –°—Ç–∞–ª–æ (–Ω–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏):

```typescript
Markup.inlineKeyboard([
  [Markup.button.callback('üíµ –û–ø–ª–∞—Ç–∏—Ç—å —Ä—É–±–ª—è–º–∏ (2000 ‚ÇΩ)', 'pay_rub_tribute')],
  [Markup.button.callback('üí≥ –ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã (22‚Ç¨)', 'pay_eur_tribute')],
  [Markup.button.callback('üí¥ –û–ø–ª–∞—Ç–∏—Ç—å –≥—Ä–∏–≤–Ω–∞–º–∏ (1050 ‚Ç¥)', 'pay_uah')]
])
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –í—Å–µ 3 —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
- ‚úÖ –ö–Ω–æ–ø–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –≤–µ–¥—É—Ç –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- ‚úÖ –ö–ª–∏–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –≤ –ë–î
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å –∫–Ω–æ–ø–∫–æ–π "–ù–∞–ø–∏—Å–∞—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É"

---

## üéØ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞

### –ö–ª–∏–∫ –Ω–∞ "–û–ø–ª–∞—Ç–∏—Ç—å —Ä—É–±–ª—è–º–∏":

1. ‚úÖ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ë–î: `actionType = 'choose_rub_tribute'`
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
üíµ –û—Ç–ª–∏—á–Ω–æ! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –∏ —É –≤–∞—Å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã, 
–≥–¥–µ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –≤ –∫–∞–Ω–∞–ª —Å –ø–ª–∞—Ç–Ω—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –∏ –Ω–∞—à —á–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–ü–æ–¥–æ–π–¥–µ—Ç –∫–∞—Ä—Ç–∞ –ª—é–±–æ–≥–æ —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞, –¥–∞–∂–µ –∫—Ä–µ–¥–∏—Ç–Ω–∞—è. 
–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –Ω–∞–∂–º–∏—Ç–µ "–ù–∞–ø–∏—Å–∞—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É" –∏ –≤–∞–º –æ—Ç–≤–µ—Ç—è—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞.

[üí≥ –û–ø–ª–∞—Ç–∏—Ç—å 2000 ‚ÇΩ]  [üì® –ù–∞–ø–∏—Å–∞—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É]
```

### –ö–ª–∏–∫ –Ω–∞ "–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã":

1. ‚úÖ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ë–î: `actionType = 'choose_eur_tribute'`
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
üí≥ –û—Ç–ª–∏—á–Ω–æ! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –∏ —É –≤–∞—Å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã, 
–≥–¥–µ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –≤ –∫–∞–Ω–∞–ª —Å –ø–ª–∞—Ç–Ω—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –∏ –Ω–∞—à —á–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–ü–æ–¥–æ–π–¥–µ—Ç –ª—é–±–∞—è –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞ –ª—é–±–æ–π —Å—Ç—Ä–∞–Ω—ã. 
–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –Ω–∞–∂–º–∏—Ç–µ "–ù–∞–ø–∏—Å–∞—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É" –∏ –≤–∞–º –æ—Ç–≤–µ—Ç—è—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞.

[üí≥ –û–ø–ª–∞—Ç–∏—Ç—å 22‚Ç¨]  [üì® –ù–∞–ø–∏—Å–∞—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É]
```

### –ö–ª–∏–∫ –Ω–∞ "–û–ø–ª–∞—Ç–∏—Ç—å –≥—Ä–∏–≤–Ω–∞–º–∏":

1. ‚úÖ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ë–î: `actionType = 'choose_uah'`
2. –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∫–∞—Ä—Ç—ã –¥–ª—è UAH
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí invite-—Å—Å—ã–ª–∫–∏

---

## üìä –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞—Å—Å—ã–ª–∫–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `npm run broadcast-stuck` –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:

```sql
-- –°–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫ –ø–æ–ª—É—á–∏–ª–∏ —Ä–∞—Å—Å—ã–ª–∫—É –∏ –Ω–∞–∂–∞–ª–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏
SELECT 
  actionType,
  COUNT(*) as clicks,
  COUNT(DISTINCT userId) as unique_users
FROM user_actions
WHERE actionType IN ('choose_rub_tribute', 'choose_eur_tribute', 'choose_uah')
  AND createdAt > '2025-11-05'  -- –¥–∞—Ç–∞ —Ä–∞—Å—Å—ã–ª–∫–∏
GROUP BY actionType;
```

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```
actionType           | clicks | unique_users
---------------------|--------|-------------
choose_rub_tribute   | 45     | 43
choose_eur_tribute   | 12     | 12
choose_uah           | 8      | 8
```

**–ö–æ–Ω–≤–µ—Ä—Å–∏—è —Ä–∞—Å—Å—ã–ª–∫–∏:**
```sql
-- –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–ª–∏–∫–Ω—É–≤—à–∏—Ö—Å—è
SELECT 
  COUNT(DISTINCT CASE WHEN currentStep IN ('start', 'video1') AND hasPaid = false THEN userId END) as sent_to,
  COUNT(DISTINCT CASE WHEN actionType IN ('choose_rub_tribute', 'choose_eur_tribute', 'choose_uah') AND createdAt > '2025-11-05' THEN ua.userId END) as clicked,
  ROUND(
    COUNT(DISTINCT CASE WHEN actionType IN ('choose_rub_tribute', 'choose_eur_tribute', 'choose_uah') AND createdAt > '2025-11-05' THEN ua.userId END)::numeric /
    COUNT(DISTINCT CASE WHEN currentStep IN ('start', 'video1') AND hasPaid = false THEN userId END)::numeric * 100,
    2
  ) as conversion_percent
FROM users u
LEFT JOIN user_actions ua ON u.userId = ua.userId;
```

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É

### –õ–æ–∫–∞–ª—å–Ω–æ (—Ç–µ—Å—Ç):

```bash
npm run broadcast-stuck
```

### –ù–∞ Railway (–ø—Ä–æ–¥–∞–∫—à–Ω):

1. –í—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç–µ `package.json` ‚Üí `scripts` ‚Üí `start`:
```json
"start": "npm run broadcast-stuck && npm run build && node dist/index.js"
```

2. –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –Ω–∞ Railway (git push)

3. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞—Å—Å—ã–ª–∫–∏ –≤–µ—Ä–Ω–∏—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ:
```json
"start": "node dist/index.js"
```

4. –°–Ω–æ–≤–∞ –∑–∞–¥–µ–ø–ª–æ–π—Ç–µ

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –†–∞—Å—Å—ã–ª–∫–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –û–î–ò–ù –†–ê–ó –ø—Ä–∏ –¥–µ–ø–ª–æ–µ!

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ö–æ–º—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è:**
- –ó–∞—Å—Ç—Ä—è–≤—à–∏–µ –Ω–∞ `start` (–Ω–µ –Ω–∞—á–∞–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ)
- –ó–∞—Å—Ç—Ä—è–≤—à–∏–µ –Ω–∞ `video1` (–Ω–∞—á–∞–ª–∏, –Ω–æ –Ω–µ –¥–æ—à–ª–∏ –¥–æ –æ–ø–ª–∞—Ç—ã)
- –ù–µ –æ–ø–ª–∞—Ç–∏–≤—à–∏–µ (`hasPaid = false`)

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:**
- –ü–æ–ª—É—á–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å 3 —Å–ø–æ—Å–æ–±–∞–º–∏ –æ–ø–ª–∞—Ç—ã
- –ö–ª–∏–∫–∏ –±—É–¥—É—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å—Å—è
- –°–º–æ–≥—É—Ç –≤—ã–±—Ä–∞—Ç—å —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
- –ü–æ–ª—É—á–∞—Ç –ø–æ–º–æ—â—å —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "–ù–∞–ø–∏—Å–∞—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É"

**–ö–æ–Ω–≤–µ—Ä—Å–∏—è:**
- –û–∂–∏–¥–∞–µ–º–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è: 15-30% (–æ—Ç –ø–æ–ª—É—á–∏–≤—à–∏—Ö —Ä–∞—Å—Å—ã–ª–∫—É –¥–æ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É)
- –ò–∑ –Ω–∏—Ö 40-60% –¥–æ–π–¥—É—Ç –¥–æ –æ–ø–ª–∞—Ç—ã

---

## ‚úÖ –ò—Ç–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|----------|------|-------|
| **–ö–Ω–æ–ø–æ–∫** | 2 | 3 |
| **–°–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã** | RUB (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç), UAH | RUB (Tribute), EUR (Tribute), UAH |
| **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ** | –¢–æ–ª—å–∫–æ UAH | –í—Å–µ 3 —Å–ø–æ—Å–æ–±–∞ |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞** | –ù–µ—Ç | –ö–Ω–æ–ø–∫–∞ "–ù–∞–ø–∏—Å–∞—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É" |
| **–°—Ç–∞—Ç—É—Å** | ‚ùå –°–ª–æ–º–∞–Ω | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |

---

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 5 –Ω–æ—è–±—Ä—è 2025  
**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:** 
- `scripts/send_stuck_users_message.ts`
- `scripts/README_STUCK_USERS.md`

‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**
